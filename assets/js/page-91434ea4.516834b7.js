(window.webpackJsonp=window.webpackJsonp||[]).push([[150],{517:function(s,n,a){"use strict";a.r(n);var e=a(2),t=Object(e.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("K3s是目前全球用户量最大的CNCF认证轻量级K8S发行版")]),s._v(" "),a("p",[s._v("官网")]),s._v(" "),a("p",[s._v("https://www.rancher.cn/k3s/")]),s._v(" "),a("p",[s._v("在线安装的镜像源在谷歌云服务器，你懂的")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("cd ~\n\nmkdir k3s\ncd k3s\n\n# 下载安装包\n# k3s可执行文件，树莓派是arm32架构\ncurl -fL https://github.com/rancher/k3s/releases/download/v0.8.1/k3s-armhf -o k3s-armhf\n# k3s运行依赖的image包，树莓派是arm32架构\ncurl -fL https://github.com/rancher/k3s/releases/download/v0.8.1/k3s-airgap-images-arm.tar -o k3s-airgap-images-arm.tar\n# 安装脚本，内部包含脚本 + 参数说明\ncurl -fL https://get.k3s.io -o install-k3s.sh && sudo chmod +x ./install-k3s.sh\n\n\n# 建立文件夹 + 拷贝文件\nsudo cp ./k3s-armhf -p /usr/local/bin/k3s && sudo chmod +x /usr/local/bin/k3s\nsudo mkdir -p /var/lib/rancher/k3s/agent/images/ && sudo cp ./k3s-airgap-images-arm.tar /var/lib/rancher/k3s/agent/images/k3s-airgap-images.tar\n\n\n# 离线安装Server （单机）\nsudo INSTALL_K3S_SKIP_DOWNLOAD=true ./install-k3s.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#更改pause镜像，修改ExecStart参数\nsudo vim /etc/systemd/system/k3s.service\n\nExecStart=/usr/local/bin/k3s \\\n    server \\\n    --pause-image=system386/pause-arm:3.1\n\nsudo systemctl daemon-reload\nsudo systemctl restart k3s\njournalctl -n 200 -u k3s.service\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("p",[s._v("查看集群")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("pi@raspberrypi:~ $ sudo kubectl get nodes,cs,svc,pods  -o wide  --all-namespaces\nNAME               STATUS   ROLES    AGE     VERSION         INTERNAL-IP      EXTERNAL-IP   OS-IMAGE                         KERNEL-VERSION   CONTAINER-RUNTIME\nnode/raspberrypi   Ready    master   3m18s   v1.14.6-k3s.1   192.168.252.66   <none>        Raspbian GNU/Linux 9 (stretch)   4.14.79+         containerd://1.2.7-k3s1\n\nNAME                                 STATUS    MESSAGE   ERROR\ncomponentstatus/controller-manager   Healthy   ok        \ncomponentstatus/scheduler            Healthy   ok        \n\nNAMESPACE     NAME                 TYPE        CLUSTER-IP   EXTERNAL-IP   PORT(S)                  AGE   SELECTOR\ndefault       service/kubernetes   ClusterIP   10.43.0.1    <none>        443/TCP                  24m   <none>\nkube-system   service/kube-dns     ClusterIP   10.43.0.10   <none>        53/UDP,53/TCP,9153/TCP   23m   k8s-app=kube-dns\n\nNAMESPACE     NAME                             READY   STATUS              RESTARTS   AGE     IP          NODE          NOMINATED NODE   READINESS GATES\nkube-system   pod/coredns-b7464766c-r4w9z      0/1     Running    0          2m23s   10.42.0.9   raspberrypi   <none>           <none>\nkube-system   pod/helm-install-traefik-dzksg   0/1     Running   0           2m26s   <none>      raspberrypi   <none>           <none>\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("修改docker引擎\nk3s默认用的不是docker而是Containerd")]),s._v(" "),a("p",[s._v("修改默认容器引擎为docker：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#安装docker\nsudo curl https://get.docker.com/ > ./docker_install.sh\nsudo sh docker_install.sh –mirror Aliyun\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[a("code",[s._v("vi /etc/systemd/system/k3s-agent.service")])]),s._v(" "),a("p",[s._v("修改ExecStart的值："),a("code",[s._v("/usr/local/bin/k3s server --docker")])]),s._v(" "),a("p",[a("code",[s._v("sudo systemctl daemon-reload && sudo systemctl restart k3s-agent")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#Containerd用法")]),s._v("\npi@raspberrypi:~ $ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" ctr images \nNAME:\n   ctr images - manage images\n\nUSAGE:\n   ctr images "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("command options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("arguments"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\nCOMMANDS:\n     check       check that an image has all content available locally\n     "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" an image\n     "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v(" images\n     list, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("    list images known to containerd\n     pull        pull an image from a remote\n     push        push an image to a remote\n     remove, "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v("  remove one or "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" images by reference\n     label       "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" and "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" labels "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" an image\n\nOPTIONS:\n   --help, -h  show "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("p",[s._v("参考")]),s._v(" "),a("p",[s._v("https://blog.csdn.net/george__qian/article/details/100772107")])])}),[],!1,null,null,null);n.default=t.exports}}]);