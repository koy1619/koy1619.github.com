(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{350:function(n,t,e){"use strict";e.r(t);var s=e(1),a=Object(s.a)({},(function(){var n=this,t=n.$createElement,e=n._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"多个excel文件合并成一个excel"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#多个excel文件合并成一个excel","aria-hidden":"true"}},[n._v("#")]),n._v(" 多个EXCEL文件合并成一个EXCEL")]),n._v(" "),e("p",[n._v("经常会接到导码需求，附件有txt的也有excel的，动辄上百个文件")]),n._v(" "),e("p",[n._v("如果是文本可以用"),e("code",[n._v("cat xxx.txt >> yyy.txt")]),n._v("来合并")]),n._v(" "),e("p",[n._v("那如果是excel就不好办了，今天就遇到了")]),n._v(" "),e("p",[n._v("要把上百个EXCEL文件合并成新一个文件")]),n._v(" "),e("p",[n._v("合并方法如下：")]),n._v(" "),e("p",[n._v("1.需要把多个excel表都放在同一个文件夹里面，并在这个文件夹里面新建一个excel。")]),n._v(" "),e("p",[n._v("2.打开新建的excel表，并右键单击sheet1，找到"),e("code",[n._v("查看代码")]),n._v("，单击进去。进去之后就看到了宏计算界面。")]),n._v(" "),e("p",[n._v("3.然后把下面这些宏计算的代码复制进去，然后找到工具栏上面的"),e("code",[n._v("运行")]),n._v("下的"),e("code",[n._v("运行子过程/用户窗体")]),n._v("，代码如下:")]),n._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[n._v("Sub 合并当前目录下所有工作簿的全部工作表"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v(")")]),n._v("\n\nDim MyPath, MyName, AWbName\nDim Wb As Workbook, WbN As String\n\nDim G As Long\n\nDim Num As Long\n\nDim BOX As String\n\nApplication.ScreenUpdating "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" False\n\nMyPath "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" ActiveWorkbook.Path\n\nMyName "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("=")]),n._v(" Dir"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("(")]),n._v("MyPath "),e("span",{pre:!0,attrs:{class:"token operator"}},[n._v("&")]),n._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('"'),e("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[n._v('\\"')]),n._v(' & "')]),n._v("*.xls"),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('")\n\nAWbName = ActiveWorkbook.Name\n\nNum = 0\n\nDo While MyName <> "')]),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('"\n\nIf MyName <> AWbName Then\n\nSet Wb = Workbooks.Open(MyPath & "')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[n._v("\\")]),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('" & MyName)\n\nNum = Num + 1\n\nWith Workbooks(1).ActiveSheet\n\n.Cells(.Range("')]),n._v("B65536"),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('").End(xlUp).Row + 2, 1) = Left(MyName, Len(MyName) - 4)\n\nFor G = 1 To Sheets.Count\n\nWb.Sheets(G).UsedRange.Copy .Cells(.Range("')]),n._v("B65536"),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('").End(xlUp).Row + 1, 1)\n\nNext\n\nWbN = WbN & Chr(13) & Wb.Name\n\nWb.Close False\n\nEnd With\n\nEnd If\n\nMyName = Dir\n\nLoop\n\nRange("')]),n._v("B1"),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('").Select\n\nApplication.ScreenUpdating = True\n\nMsgBox "')]),n._v("共合并了"),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('" & Num & "')]),n._v("个工作薄下的全部工作表。如下："),e("span",{pre:!0,attrs:{class:"token string"}},[n._v('" & Chr(13) & WbN, vbInformation, "')]),n._v('提示"\n\nEnd Sub\n')])])]),e("p",[n._v("4.点击运行之后，等待合并（合并文件越多耗时越久），等运行完毕，会有提示，点确定就可以了；查看合并后的数据。")]),n._v(" "),e("blockquote",[e("ul",[e("li",[n._v("ps: 被合并excel版本必须相同，上面代码是合并后缀为"),e("code",[n._v("xls")]),n._v("的excel, 如果是Excel2007那就要改为"),e("code",[n._v("xlsx")])])])]),n._v(" "),e("p",[n._v("转载自：")]),n._v(" "),e("p",[n._v("https://zhidao.baidu.com/question/96195372.html")])])}),[],!1,null,null,null);t.default=a.exports}}]);