(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{536:function(s,t,a){"use strict";a.r(t);var n=a(2),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("blockquote",[a("p",[s._v("这里我们只介绍 GitLab 和 GitHub 的 pages 功能的部署。")])]),s._v(" "),a("h2",{attrs:{id:"github"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github"}},[s._v("#")]),s._v(" GitHub")]),s._v(" "),a("p",[s._v("打开项目设置的 "),a("code",[s._v("GitHub Pages")]),s._v(" 模块，将 "),a("code",[s._v("Source")]),s._v(" 设置为 "),a("code",[s._v("gh-pages")]),s._v("，这样我们就可以将博客项目放在 "),a("code",[s._v("master")]),s._v(" 分支，而部署到 "),a("code",[s._v("gh-pages")]),s._v(" 分支。")]),s._v(" "),a("h3",{attrs:{id:"手动部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动部署"}},[s._v("#")]),s._v(" 手动部署")]),s._v(" "),a("p",[s._v("在根目录建一个 "),a("code",[s._v("deploy.sh")]),s._v(" 文件：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确保脚本抛出遇到的错误")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" -e\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run docs:build\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入生成的文件夹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" docs/.vuepress/dist\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果是发布到自定义域名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 'www.example.com' > CNAME")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -A\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'deploy'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果发布到 https://<USERNAME>.github.io")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -f git@github.com:<USERNAME>/<USERNAME>.github.io.git master")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果发布到 https://<USERNAME>.github.io/<REPO>")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -f git@github.com:<USERNAME>/<REPO>.git master:gh-pages")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" -\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("div",{staticClass:"custom-block warning"},[a("p",[s._v("如果你用的 MAC，在项目根目录借助 "),a("code",[s._v("终端")]),s._v(" 执行 "),a("code",[s._v("bash deploy.sh")]),s._v(" 即可；如果你使用的是 WINDOWS，在项目根目录借助 "),a("code",[s._v("Git Bash")]),s._v(" 执行 "),a("code",[s._v("bash deploy.sh")]),s._v(" 即可。")])]),s._v(" "),a("h3",{attrs:{id:"自动部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动部署"}},[s._v("#")]),s._v(" 自动部署")]),s._v(" "),a("p",[a("code",[s._v("GitHub")]),s._v(" 的自动部署需要借助 "),a("code",[s._v("travis-ci")]),s._v(" 。")]),s._v(" "),a("ol",[a("li",[s._v("打开 "),a("a",{attrs:{href:"https://travis-ci.com/",target:"_blank",rel:"noopener noreferrer"}},[s._v("travis-ci"),a("OutboundLink")],1),s._v("，使用 "),a("code",[s._v("GitHub")]),s._v(" 登录；")]),s._v(" "),a("li",[s._v("进入设置页面，点击 "),a("code",[s._v("Manage repositories on GitHub")]),s._v(" 按钮，将需要自动部署的项目导入进来；")]),s._v(" "),a("li",[s._v("项目列表中，项目后面有一个 "),a("code",[s._v("settings")]),s._v(" 按钮，点击进去将进行配置：\n"),a("ol",[a("li",[s._v("获取 "),a("code",[s._v("token")]),s._v("：进入github的设置页面，点击 "),a("code",[s._v("Developer settings")]),s._v(" 按钮，点击 "),a("code",[s._v("Personal access tokens")]),s._v(" 按钮，在当前页面生成 "),a("code",[s._v("token")]),s._v("，名字随便写，只是起到区分作用；")]),s._v(" "),a("li",[s._v("配置 "),a("code",[s._v("token")]),s._v("：将上面生成的 "),a("code",[s._v("token")]),s._v(" 添加在项目的设置页面的 "),a("code",[s._v("Environment Variables")]),s._v("，切记，名字不可随便写，在这里你写成 "),a("code",[s._v("GITHUB_TOKEN")]),s._v("；")]),s._v(" "),a("li",[s._v("配置 "),a("code",[s._v("Cron Jobs")]),s._v("：（如果你的项目就在 "),a("code",[s._v("master")]),s._v(" 分支，可以不用配置这里）"),a("code",[s._v("Branch")]),s._v(" 选择 你存放项目源码的分支，"),a("code",[s._v("Interval")]),s._v(" 选择 "),a("code",[s._v("monthly")]),s._v("，"),a("code",[s._v("Options")]),s._v(" 选择 "),a("code",[s._v("Always run")]),s._v("，添加成功后便会生效。")])])]),s._v(" "),a("li",[s._v("在根目录下创建 "),a("code",[s._v(".travis.yml")]),s._v("（"),a("a",{attrs:{href:"https://docs.travis-ci.com/user/deployment/pages/",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置规范"),a("OutboundLink")],1),s._v("）："),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("language")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" node_js\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("node_js")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" lts/*\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" npm run build\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("provider")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pages\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("skip-cleanup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("local_dir")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" docs/.vuepress/dist "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 项目打包后生成的文件的目录")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("github-token")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" $GITHUB_TOKEN "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这里这个变量就是刚才配置 token 时填写的那个变量")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("keep-history")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean important"}},[s._v("true")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("on")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 项目源码所在的分支")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])])]),s._v(" "),a("li",[s._v("现在去提交一下代码试试吧，在你提交成功后 "),a("code",[s._v("travis-ci")]),s._v(" 的控制台就能看到你的项目在部署了。")])]),s._v(" "),a("h2",{attrs:{id:"gitlab"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gitlab"}},[s._v("#")]),s._v(" GitLab")]),s._v(" "),a("h3",{attrs:{id:"手动部署-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#手动部署-2"}},[s._v("#")]),s._v(" 手动部署")]),s._v(" "),a("ol",[a("li",[a("p",[s._v("设置输出目录为 "),a("code",[s._v("public")]),s._v("：")]),s._v(" "),a("p",[s._v("由于 "),a("code",[s._v("GitLab")]),s._v(" 的 "),a("code",[s._v("pages")]),s._v(" 功能的指定文件夹是 "),a("code",[s._v("public")]),s._v("，所以我们要将项目的输出目录改为 "),a("code",[s._v("public")]),s._v("，也就是将 "),a("code",[s._v("config.js")]),s._v(" 的 "),a("code",[s._v("dest")]),s._v(" 设置为 "),a("code",[s._v("public")]),s._v("；")])]),s._v(" "),a("li",[a("p",[s._v("本地编译，然后将项目提交到 "),a("code",[s._v("GitLab")]),s._v(" 即可。")])])]),s._v(" "),a("h3",{attrs:{id:"自动部署-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动部署-2"}},[s._v("#")]),s._v(" 自动部署")]),s._v(" "),a("ol",[a("li",[s._v("设置输出目录为 "),a("code",[s._v("public")]),s._v("；")]),s._v(" "),a("li",[s._v("由于 "),a("code",[s._v("GitLab")]),s._v(" 自带 CI，所以就省去了很多的配置步骤，只需要在项目根目录创建 "),a("code",[s._v(".gitlab-ci.yml")]),s._v("（"),a("a",{attrs:{href:"https://docs.gitlab.com/ee/ci/yaml/README.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("配置规范"),a("OutboundLink")],1),s._v("）："),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("9.11.1\n\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("pages")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("cache")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("paths")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" node_modules/ "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 缓存 node_modules，加速编译")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" npm install\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" npm run docs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("build\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("artifacts")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("paths")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" public\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("only")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" master\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])])]),s._v(" "),a("li",[s._v("将项目提交到 "),a("code",[s._v("GitLab")]),s._v(" 即可。")])])])}),[],!1,null,null,null);t.default=e.exports}}]);