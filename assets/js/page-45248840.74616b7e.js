(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{354:function(s,e){s.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAngAAABCCAYAAADE6avYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAyJSURBVHhe7Z1Ni93IFYb7JzUGL/w3ehEvehFDjIlhFoEmi2BIQzDemv4BBuOtoZde2gbvGuJAIBAwEwIG48nKm0w+pieKjqRqHR2d0ldL3SXpOfAwUr2qo5J0r87rKt/xwbdv3zLL6wcH2cHB3ezZx7ZW8zF7djc/7sHruu31g7yf9I2gj51KcY4H2eti/3X2QOW/++xj+3gAAFgM6gVAmrgGDwAAAADWCwYPAAAAYGNg8AAAAAA2BgYPAAAAYGNg8AAAAAA2BgYPAAAAYGNg8AAAAAA2BgYPAAAAYGMcvHz5MgMAABAkdJHwjgGA9LmRGbzLfzxr0NK/fAEAgGtizdkUbA4pFHp/abIfvmvQ0j9/BoABYPAAADaCNWdTsDkweADrBIMHALARrDmbgs2BwQNYJ4MM3sOHDws8bQjLG7yL7MXRYXZ4WHL/7KLWLs6y+3nbk3N9/HTentTncXPOfD4AgKFYczYFm2OowbtunQgsb/A+ZM/vHGQHByX3Tj/U2ofT7F7e9uiVPn46b47r87g5Zz7fzZPfu/xe5hdYoq/j1XHdfudU9YGbYrDB++lvv5n85V3c4J2fZIdHZ9n3nraI4SoNJQYPAFLCmrMp2BxDDJ7Uhv/98Id1GLzceBzkhuOTpy1iuEpDuV2Ddye/Dk+ryK8Rg3c7NAyefDlj/PfTd9l//vrrYlv3GcLSBu/7s6Ps8OTc1Zahw+ABANwS1pxNweboM3hSE8Tc/fzl942aYfH6eixt8D6d3skOjl+52jJ0GLzVg8FLmZbBC1/Uy8+/y376+2+Lmbtg7v79l19l//rzL0d9WYWlDF5h7Krl0pqT7G2lx5dTz7Mn+XEvVH+9rKv7tfsKvsGLn6+5hFxSjzPM+nl9JeeTM63H+zWWpgWZ2czb2+MHgC1izZnl3bt3brvG5ugyeEvUjKUMXmHsDuol05Lj7E2lx5dTX2WP8uOeq/56WVf3a/cVfIMXP19zCbmkHmeY9fP6Ss5Hp1qP92ssTQsys5m3t8ffBQYvZVoGr++L+uOfjrMf//iLUV/YpQxeoHsGzzNjYvByUxT6FEZIGSdNYaKs1jWD1z+79/bkKHtxEfZLs1nnl/1aL0yjWn4uDF+VW2+7YPAAdoU1ZxoxdwFPD9gcMYM31NxJzUjB4AW6Z/A8MyYGLzdFoU9hhJRx0hQmympdM3j9s3tvju9kz68MVGk26/yyX+uFaVTLz4Xhq3LrbRcM3uZoGbwh5u6fF0cbMHh2JkztV8aoZj6DJ2NtaGYWrqRp8LpyFcff6PI0AKSKNWcBbe76TJ7N0WXwlpgQSNPg2ZkwtV8Zo5r5DJ6MtaGZWbiSpsHrylUcP+vyNAYvZVoGb25zJ6zL4DVn0GadwRPjaMcpbbEfiOT0ztIJwZBi9AB2jTVngjV1dt9ic/Qt0c5dM9Zl8JozaC3zVzDR4IlxtOOUNjVDZ+mdpROCIZ3F6GHwUmbwjyymmjthVQav2DZLpLMYvPycrpGTscRN3CCDJ3hGlCVagF1hzZngmbm5DJ4gNSGYO10zLF5fj1UZvGLbLJHOYvDyc7pGTsYSN3GDDJ7gGVGWaDdHw+DFkC/nVHMn3I7BK41WvexZUpqdrhm8YOpK7p+dqWO7co7V7Cyh0iJ/565JO2frOAwewK6w5kyIGbm5DJ4gtUFm7qbWCM3tGLzSaNXLniWl2emawQumruTe6ak6tivnWM3OEipNGcG4wWvnbB2Hwdscgw3edb64Sxs8AADo/pHFUGyOIQZPuG6dCCxt8GBOMHgpM8jgXRcMHgDA8lhzNgWbY6jBmwsM3prA4KUMBg8AYCNYczYFmwODB3HE4PFPlaUKBg8AYCNYczYFmwODB7BOOg3e06dP3fax9Bm8i4sLAAC4JtacTcHmGGrwHj9+7LaPpc/gvX//HgAGkIzB8/40CgAAw9iTwfuSX68N3YaObmOPOgYPAGAD7MngSUwpeDrQ0UNsVd+5wcvPe3SYXR5W6H+s/+KsbJvr/yF3os7j5Zz7fLNT3avR4zvPr+vEaV+Kmz7fAK77bIv+iV0TJMfeDJ6EFDGvuIVAR9+zvm+Dd54XzaO8eHraIoarwyRh8GZigwbv7Kj5hw8ABwxeO9DR96zv2+BJ4bzRf791qklKAQze7SDXk39Ow796AhBhbwZPFzavyKGjh9irvk+DJ8ZOZlQaKFMQXU6tzIPur2dWdL9WXyFikqLnq47XOfU4w8xQQPeVnGda7+g3aHbIjD3cg2LfmKoif9ivNJkt9c7XdQ3RcXY9h2ucb8w90/26iD7bnCE55Toafwjpuvac2GdQjg/XJrPW4bigz/4ccmJjcfWB9zo6FtiTwZta8EKgo9vYos4MXnQGLx9Ty4xJQcvbQp/CRKjCpCkKkdW8nEO0ipN8vFczOVVxvdJlX+lSPPXys+yH3Hp7MGp8NrcdS+PazT0rtDDOAdfgjrMvp9Iaz0i0nvO596ynXy/Os22M2dm/6mfb5Nyx6zPo51CYMNmu+osxKkxf/t++65v0HAx6LILkDP0aTB0L7G0GzwspbF7xC4GOvid9/QZPz9SEwuUd5zHJ4KniY4uWHUujUAleziFajoxVa8W59bmEgYWwKPa5Hr12j2p8br+u+2I0fZ191xAdZ0fOrrFMvWd9/Xpxnq332bPnl89T6++IdlyfEPsMXp1P+ldjlzb5vizyHHKi3wc1hqu+FZPHAhi89AqsDXT0m9SZwYsWCqcodxZXU7Rs4S3wcg7QpFDacbrFXzFkpiMU4EHFMoxPrtPm7rsvStPX2XcNgdY4O3J2jWXqPRs6zijOs/U+e/b87ng6rq/QIp/Bq/OpY6RNDN5izyEyFqtpJo8F9mTwvCKn29DRbexRx+BFC4RTlG1B00Wr2FZFS4pzo/gJXs4+LT+nW/BkLLFcOUMMntAovBWheDb6q/EVfbQuYwnXXh3XKOYqf5Fba1PG2ZdTaa1+HeeL3rMB43TvWcB5tvbz4u1Hn3vk+mwO/RnsMnhDri+gz2fHop9D11jC/XC/e1PHAnubwZtS8HSgo4fYqo7BaxWZYFAMRcExBc0WmKKIVRR/od0UNJ1PKHKO1VTRLM6vNG0IombFyWmPk/vSaq/6hbZgaMKSeOhTtOlrrwr2FWr8QvQausbZlbPnGU26Zzld/YSue6b76WPCPSww90XG4v51g4mfwavPuvSvziVt4RyzP4ec6PdBsHntNSlt0FhgbwZPQoqYV9xCoKPvWd+3wYOVYkzO1rCmLVk2/hxWBgavHejoQiy2rvcaPI13zBAweDAvGIs04DmkRAoGT+MdM4ShBk8XNq/IoaOH2KveafDmAoMH84KxSAOeQ0rctsGbiyEGb2rBC4GObmOLejIGDwAAroeEfb+OxeZI0eABQD9JGLyvX79ml5eXLqKho3uagI6OXuvWnE3B5rhpg9eHN3sRQjR09FjsTU/C4IUXVXhJBXQbOrrWbBs6utZs2150Cft+HYvNkZrBk/CKnG5DR7exRz0Zgxd7YWnQ0b1trw0dXWu2bau6hH2/jsXmSNHgSUwpeDrQ0UNsVU/K4IWXlPfyCqCjo6N7mrB3XcK+X8dic6Rq8CSkiHnFLQQ6+p51DJ4BHR0d3dOE1HUJ+34di82BwUOPBXraOku0CnR0b9trQ0fXmm27LV3Cvl/HYnOwRIuOvk6dH1k4214bOrrWbBs6utZs203pEvb9Ohabgx9ZlIGOHmItehIGz3t5BURDR/c0AR0dvdYl7Pt1LDZHagbPK24hRENHj8XedAweOjq6qwno69Il7Pt1LDYHBq8OdPQ16SzROtteGzq61mwbOrrWbNtN6RL2/ToWm4Ml2jLQ6zb0ejtEijo/slCgo3vbXhs6utZs223pEvb9Ohabgx9ZoKOvU0/K4IWXlPfyCqCjo6N7mrB3XcK+X8dic6Rq8CSkiHnFLQQ6+p51DJ4BHR0d3dOE1HUJ+34di82BwUOPBXraOku0CnR0b9trQ0fXmm27LV3Cvl/HYnOwRIuOvk6dH1k4214bOrrWbBs6utZs203pEvb9Ohabgx9ZlIGOHmItehIGz3t5BURDR/c0AR0dvdYl7Pt1LDZHagbPK24hRENHj8Xe9BsxeAAAsDwSXvsYbI7UDB4ADAODBwCwEaw5m4LNgcEDWCcYPACAjWDN2RRsDgwewDrB4AEAbARrzqZgc2DwANYJBg8AYCNYczYFmwODB7BOMHgAABvBmrMp2BwYPIB1gsEDANgI1pxNwebA4AGsEwweAMBGsOZsCjYHBg9gjXzL/g+e1IJykgtgSQAAAABJRU5ErkJggg=="},433:function(s,e,a){"use strict";a.r(e);var t=a(2),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("p",[t("strong",[s._v("问题背景")])]),s._v(" "),t("p",[s._v("部署"),t("code",[s._v("KubeSphere")]),s._v("中间有问题，删除集群重新部署的，导致命名空间状态一直处于"),t("code",[s._v("Terminating")]),s._v("，使用"),t("code",[s._v("kubectl get all -n $NAMESPACE")]),s._v("命令显示已经没有资源，但仍无法删除。")]),s._v(" "),t("p",[s._v("命名空间无法删除通常是因为还有资源在使用这个命名空间，这个资源可能自己的状态也已经不正常了，或者是因为不正确的操作导致有空耦合")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@k8s-master ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl  get ns")]),s._v("\nNAME                           STATUS        AGE\nistio-system                   Active        21h\npaas-app                       Active        44d\nkube-system                    Active        44d\nkubesphere-controls-system     Terminating   21h\nkubesphere-devops-system       Terminating   21h\nkubesphere-logging-system      Terminating   21h\nkubesphere-monitoring-system   Terminating   23h\nkubesphere-system              Terminating   23h\nopenpitrix-system              Terminating   21h\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("三种尝试方法，最后一个终于成功删除了，此处记录一下")]),s._v(" "),t("p",[t("strong",[s._v("1. 强制删除")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl delete namespace kubesphere-system --force --grace-period"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("strong",[s._v("2. 使用api删除")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#先安装jq")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" -ivh epel-release-latest-7.noarch.rpm\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y jq\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NAMESPACE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("kubesphere-system\nkubectl proxy "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\nkubectl get namespace "),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NAMESPACE")]),s._v(" -o json "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("jq "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.spec = {\"finalizers\":[]}'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("temp.json\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -k -H "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Content-Type: application/json"')]),s._v(" -X PUT --data-binary @temp.json "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1:8001/api/v1/namespaces/"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$NAMESPACE")]),s._v("/finalize\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("strong",[s._v("3. "),t("code",[s._v("kubectl edit")]),s._v("修改状态")])]),s._v(" "),t("p",[t("code",[s._v("kubectl edit namespace kubesphere-system")])]),s._v(" "),t("p",[s._v("将"),t("code",[s._v("finalizers")]),s._v("这条"),t("code",[s._v("value")]),s._v("改为"),t("code",[s._v("finalizers: []")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(354),alt:"微信图片_20191108104510.png"}})]),s._v(" "),t("p",[s._v("保存即可看到该"),t("code",[s._v("namespace")]),s._v("已被删除")]),s._v(" "),t("p",[s._v("也可以使用")]),s._v(" "),t("p",[t("code",[s._v('kubectl patch ns kubesphere-system -p \'{"metadata":{"finalizers":null}}\'')])]),s._v(" "),t("p",[s._v("参考")]),s._v(" "),t("p",[s._v("https://blog.csdn.net/fengwuxichen/article/details/87877214")]),s._v(" "),t("p",[s._v("https://segmentfault.com/a/1190000016924414")])])}),[],!1,null,null,null);e.default=n.exports}}]);