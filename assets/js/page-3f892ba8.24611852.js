(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{449:function(s,a,t){"use strict";t.r(a);var e=t(1),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"centos上搭建私有maven仓库-迁移，升级"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos上搭建私有maven仓库-迁移，升级","aria-hidden":"true"}},[s._v("#")]),s._v(" CentOS上搭建私有maven仓库(迁移，升级)")]),s._v(" "),t("h2",{attrs:{id:"安装jdk"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装jdk","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装JDK")]),s._v(" "),t("p",[s._v("此处省略。。。")]),s._v(" "),t("h2",{attrs:{id:"安装maven"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装maven","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装maven")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://mirrors.tuna.tsinghua.edu.cn/apache/maven/maven-3/3.5.0/binaries/apache-maven-3.5.0-bin.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" zxvf apache-maven-3.5.0-bin.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" apache-maven-3.5.0  /usr/local/\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PATH='),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v(':/usr/local/apache-maven-3.5.0/bin/"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/profile\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/profile\nmvn -v\n")])])]),t("h2",{attrs:{id:"安装sonatype-nexus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装sonatype-nexus","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装Sonatype Nexus")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" http://download.sonatype.com/nexus/oss/nexus-2.11.1-01-bundle.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" zxvf nexus-2.11.1-01-bundle.tar.gz \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" nexus-2.11.1-01 /usr/local/nexus\n")])])]),t("h2",{attrs:{id:"配置sonatype-nexus"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置sonatype-nexus","aria-hidden":"true"}},[s._v("#")]),s._v(" 配置Sonatype Nexus")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /usr/local/nexus/conf/nexus.properties \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Jetty section")]),s._v("\napplication-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#访问端口")]),s._v("\napplication-host"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0\nnexus-webapp"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bundleBasedir}")]),s._v("/nexus  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#程序目录")]),s._v("\nnexus-webapp-context-path"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/nexus     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#访问路径")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Nexus section")]),s._v("\nnexus-work"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bundleBasedir}")]),s._v("/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("/sonatype-work/nexus "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#数据存放路径")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("runtime")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${bundleBasedir}")]),s._v("/nexus/WEB-INF\n")])])]),t("h2",{attrs:{id:"sonatype-nexus启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#sonatype-nexus启动","aria-hidden":"true"}},[s._v("#")]),s._v(" Sonatype Nexus启动")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" /usr/local/nexus/bin/nexus /etc/init.d/nexus\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/init.d/nexus\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#修改以下两个参数")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NEXUS_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/local/nexus"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("RUN_AS_USER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n")])])]),t("p",[s._v("启动Nexus")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x /etc/init.d/nexus\n/etc/init.d/nexus start\n")])])]),t("p",[s._v("nexus安装完成以后，一般在路径： http://sever_ip:8081/nexus/")]),s._v(" "),t("p",[s._v("打开以后会出现配置管理页面，说明安装成功了。点击右上角“Log in”，输入用户名和密码（默认用户名：admin密码：admin123）登录。")]),s._v(" "),t("h2",{attrs:{id:"升级nexus3"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#升级nexus3","aria-hidden":"true"}},[s._v("#")]),s._v(" 升级nexus3")]),s._v(" "),t("p",[s._v("后续要使用docker虚拟容器,需要把nexus2升级到nexus3")]),s._v(" "),t("p",[s._v("https://www.sonatype.com/download-oss-sonatype?hsCtaTracking=10655413-f621-4c62-be46-df84cf6b6b90%7C79f798b3-f0df-4370-b569-0eda6e14390e")]),s._v(" "),t("p",[s._v("由于最新版本"),t("code",[s._v("3.3.1-01")]),s._v("必须通过"),t("code",[s._v("2.14.4-03")]),s._v("版本升级(前面已经安装了"),t("code",[s._v("2.11.1")]),s._v("版本,尝试过"),t("code",[s._v("2.11.1")]),s._v("无法直接升级到"),t("code",[s._v("3.3.1-01")]),s._v(")")]),s._v(" "),t("p",[s._v("所以需要安装"),t("code",[s._v("2.14.4-03")]),s._v("版本过渡升级")]),s._v(" "),t("h3",{attrs:{id:"安装nexus-2-14-4-03"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nexus-2-14-4-03","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装nexus-2.14.4-03")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /opt/nexus/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir nexus-2.14.4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd nexus-2.14.4")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget https://sonatype-download.global.ssl.fastly.net/nexus/oss/nexus-2.14.4-03-bundle.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar zxvf nexus-2.14.4-03-bundle.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\n总用量 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("71416")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v(" root root     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("月   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("23")]),s._v(":19 nexus-2.14.4-03\n-rw-r--r--. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("73117829")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":39 nexus-2.14.4-03-bundle.tar.gz\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(":12 sonatype-work\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd nexus-2.14.4-03")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim bin/nexus")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("RUN_AS_USER")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("root\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim conf/nexus.properties ")]),s._v("\napplication-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8082")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/nexus start")]),s._v("\n")])])]),t("p",[s._v("访问 http://10.10.3.225:8082/nexus")]),s._v(" "),t("h3",{attrs:{id:"_2-11-1迁移到2-14-4"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-11-1迁移到2-14-4","aria-hidden":"true"}},[s._v("#")]),s._v(" 2.11.1迁移到2.14.4")]),s._v(" "),t("p",[s._v("2.X版本的nexus可以直接拷贝仓库目录进行迁移")]),s._v(" "),t("p",[s._v("拷贝2.11.1仓库目录到2.14.4-03")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/nexus-2.11.1/sonatype-work\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" zcvf nexus.tar.gz nexus/\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("scp")]),s._v(" nexus.tar.gz root@10.10.3.225:/opt/nexus/nexus-2.14.4/sonatype-work\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# root@10.10.3.225")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/nexus/nexus-2.14.4/sonatype-work\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf nexus\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" zxvf nexus.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /opt/nexus/nexus-2.14.4/nexus-2.14.4-03\n./bin/nexus restart\n")])])]),t("p",[s._v("访问 http://10.10.3.225:8082/nexus 可以看到仓库已经迁移成功")]),s._v(" "),t("h3",{attrs:{id:"安装nexus-3-3-1-01"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装nexus-3-3-1-01","aria-hidden":"true"}},[s._v("#")]),s._v(" 安装nexus-3.3.1-01")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /opt/nexus/")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir nexus-3.3.1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd nexus-3.3.1")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget https://sonatype-download.global.ssl.fastly.net/nexus/3/nexus-3.3.1-01-unix.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# tar zxvf nexus-3.3.1-01-unix.tar.gz")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ll")]),s._v("\n总用量 "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("104836")]),s._v("\ndrwxr-xr-x. "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(" root root      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":58 nexus-3.3.1-01\n-rw-r--r--.  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("107336558")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10")]),s._v(":46 nexus-3.3.1-01-unix.tar.gz\ndrwxr-xr-x.  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" root root      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4096")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v("月  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("11")]),s._v(":58 sonatype-work\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd nexus-3.3.1-01")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim etc/nexus-default.properties")]),s._v("\napplication-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8083")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ./bin/nexus start")]),s._v("\n")])])]),t("p",[s._v("访问 http://10.10.3.225:8083/nexus")]),s._v(" "),t("h3",{attrs:{id:"迁移数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#迁移数据","aria-hidden":"true"}},[s._v("#")]),s._v(" 迁移数据")]),s._v(" "),t("h4",{attrs:{id:"配置nexus-2-14-4的upgrade-agent"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置nexus-2-14-4的upgrade-agent","aria-hidden":"true"}},[s._v("#")]),s._v(" 配置"),t("strong",[s._v("nexus-2.14.4")]),s._v("的"),t("strong",[s._v("Upgrade:Agent")])]),s._v(" "),t("p",[s._v("登陆 http://10.10.3.225:8082/nexus")]),s._v(" "),t("p",[s._v("Administration--\x3eCapabilities--\x3eNew--\x3eUpgrade: Agent--\x3eAccess Token--\x3e12345678")]),s._v(" "),t("p",[s._v("上面的流程是登陆"),t("strong",[s._v("nexus-2.14.4")]),s._v("配置"),t("code",[s._v("Upgrade:Agent")]),s._v("和"),t("code",[s._v("Access Token")]),s._v("在此我们配置的是12345678")]),s._v(" "),t("h4",{attrs:{id:"配置nexus-3-3-1的upgrade"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置nexus-3-3-1的upgrade","aria-hidden":"true"}},[s._v("#")]),s._v(" 配置"),t("strong",[s._v("nexus-3.3.1")]),s._v("的"),t("strong",[s._v("Upgrade")])]),s._v(" "),t("p",[s._v("登陆 http://10.10.3.225:8083/nexus")]),s._v(" "),t("p",[s._v("Administration--\x3eSystem--\x3eCapabilities--\x3eCreate capability--\x3eCreate Upgrade Capability")]),s._v(" "),t("h4",{attrs:{id:"通过task迁移数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#通过task迁移数据","aria-hidden":"true"}},[s._v("#")]),s._v(" 通过Task迁移数据")]),s._v(" "),t("p",[s._v("Administration--\x3eSystem--\x3eUpgrade--\x3eNext--\x3eURL&access token--\x3eNext...")]),s._v(" "),t("p",[s._v("URL: http://10.10.3.225:8082/nexus\nAccess Token: 12345678")]),s._v(" "),t("p",[s._v("数据迁移完毕，验证仓库数据。")]),s._v(" "),t("p",[s._v("参考：")]),s._v(" "),t("p",[s._v("http://www.ilanni.com/?p=12366")])])}),[],!1,null,null,null);a.default=n.exports}}]);