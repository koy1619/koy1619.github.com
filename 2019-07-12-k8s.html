<!DOCTYPE html><html><head><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta charset="utf-8"><title>kubernetes集群搭建 - linux48</title><meta name="description" content=""><meta name="author" content=""><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1"><link rel="stylesheet" href="assets/css/bulma.min.css"><link rel="stylesheet" href="assets/css/app.css"><!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]--><link rel="shortcut icon" href=""></head><body><nav class="columns navbar"><div class="column logo is-3 is-offset-1"><a class="is-brand" href="index.html">linux48</a></div></nav><div class="columns content"><div class="column is-2-desktop is-3-widescreen is-hidden-touch"></div><div class="column article-container is-11-tablet is-8-desktop is-6-widescreen"><div class="breadcrumb-area"><a href="index.html" class="breadcrumb-item">Home</a><span class="breadcrumb-delimiter"> &gt; </span><a href="2019-07-12-k8s.html" class="breadcrumb-item">kubernetes集群搭建</a></div><h1 class="article-title">kubernetes集群搭建</h1><p>作者：<a href="http://linux48.com" target="_blank">Chris</a></p><div class="article"><h1 id="操作系统要求">操作系统要求 <a class="markdownIt-Anchor" href="#操作系统要求">#</a></h1><pre class="hljs"><code>[root@localhost ~]<span class="hljs-comment"># uname -a</span>
Linux localhost.localdomain 3.10.0-514.6.1.el7.x86_64 <span class="hljs-comment">#1 SMP Wed Jan 18 13:06:36 UTC 2017 x86_64 x86_64 x86_64 GNU/Linux</span>
[root@localhost ~]<span class="hljs-comment"># cat /etc/redhat-release </span>
CentOS Linux release 7.3.1611 (Core)
</code></pre><h1 id="节点分配">节点分配 <a class="markdownIt-Anchor" href="#节点分配">#</a></h1><table><thead><tr><th style="text-align:center">节点及功能</th><th style="text-align:center">主机名</th><th style="text-align:center">ip</th></tr></thead><tbody><tr><td style="text-align:center">kube-apiserver、kube-controller-manager、kube-scheduler、docker、etcd、registry、flannel</td><td style="text-align:center">K8s-master</td><td style="text-align:center">10.1.1.100</td></tr><tr><td style="text-align:center">kubelet、kubeproxy、docker、flannel</td><td style="text-align:center">K8s-node-1</td><td style="text-align:center">10.1.1.101</td></tr><tr><td style="text-align:center">kubelet、kubeproxy、docker、flannel</td><td style="text-align:center">K8s-node-2</td><td style="text-align:center">10.1.1.102</td></tr></tbody></table><h1 id="基础配置">基础配置 <a class="markdownIt-Anchor" href="#基础配置">#</a></h1><pre class="hljs"><code>hostnamectl --static <span class="hljs-built_in">set</span>-hostname  k8s-master
hostnamectl --static <span class="hljs-built_in">set</span>-hostname  k8s-node-1
hostnamectl --static <span class="hljs-built_in">set</span>-hostname  k8s-node-2
</code></pre><pre class="hljs"><code>cat /etc/hosts
10.1.1.100    k8s-master
10.1.1.100    etcd
10.1.1.100    registry
10.1.1.101    k8s-node-1
10.1.1.102    k8s-node-2
</code></pre><pre class="hljs"><code>systemctl <span class="hljs-built_in">disable</span> firewalld.service
systemctl stop firewalld.service
</code></pre><h1 id="all-所有机器安装-docker-和-kubernetes">all 所有机器安装 docker 和 kubernetes <a class="markdownIt-Anchor" href="#all-所有机器安装-docker-和-kubernetes">#</a></h1><pre class="hljs"><code>yum update -y
yum remove -y docker
yum install -y yum-utils
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo
yum -y install docker kubernetes
cat /etc/docker/daemon.json
{ <span class="hljs-string">"insecure-registries"</span>:[<span class="hljs-string">"registry:5000"</span>] }
systemctl start docker
systemctl <span class="hljs-built_in">enable</span> docker
docker version
</code></pre><h1 id="master-启动私服">master 启动私服 <a class="markdownIt-Anchor" href="#master-启动私服">#</a></h1><pre class="hljs"><code>docker run -d -p 5000:5000 --name=registry --restart=always --privileged=<span class="hljs-literal">true</span>  --<span class="hljs-built_in">log</span>-driver=none -v /home/data/registrydata:/tmp/registry registry
</code></pre><h1 id="国外机器拉取被河蟹的镜像并保存传到国内">国外机器拉取被河蟹的镜像并保存传到国内 <a class="markdownIt-Anchor" href="#国外机器拉取被河蟹的镜像并保存传到国内">#</a></h1><pre class="hljs"><code>docker pull gcr.io/google_containers/kubernetes-dashboard-amd64:v1.7.1
docker pull registry.access.redhat.com/rhel7/pod-infrastructure:latest
docker pull gcr.io/google_containers/k8s-dns-kube-dns-amd64:1.14.4
docker pull myhub.fdccloud.com/library/kubedns-amd64:1.9
docker pull myhub.fdccloud.com/library/kube-dnsmasq-amd64:1.4
docker pull myhub.fdccloud.com/library/dnsmasq-metrics-amd64:1.0
docker pull myhub.fdccloud.com/library/exechealthz-amd64:1.2

docker save gcr.io/google_containers/kubernetes-dashboard-amd64:v1.7.1 &gt; kubernetes-dashboard-amd64.tar
docker save registry.access.redhat.com/rhel7/pod-infrastructure:latest &gt; pod-infrastructure.tar
docker save gcr.io/google_containers/k8s-dns-kube-dns-amd64:1.14.4 &gt; k8s-dns-kube-dns-amd64.tar
docker save myhub.fdccloud.com/library/kubedns-amd64:1.9  &gt; kubedns-amd64.tar
docker save myhub.fdccloud.com/library/kube-dnsmasq-amd64:1.4  &gt; kube-dnsmasq-amd64.tar
docker save myhub.fdccloud.com/library/dnsmasq-metrics-amd64:1.0  &gt; dnsmasq-metrics-amd64.tar
docker save myhub.fdccloud.com/library/exechealthz-amd64:1.2  &gt; exechealthz-amd64.tar
</code></pre><h1 id="node-1导入镜像">node-1导入镜像 <a class="markdownIt-Anchor" href="#node-1导入镜像">#</a></h1><pre class="hljs"><code>docker load &lt; kubernetes-dashboard-amd64.tar
docker load &lt; pod-infrastructure.tar
docker load &lt; k8s-dns-kube-dns-amd64.tar
docker load &lt; kubedns-amd64.tar
docker load &lt; kube-dnsmasq-amd64.tar
docker load &lt; dnsmasq-metrics-amd64.tar
docker load &lt; exechealthz-amd64.tar
</code></pre><h1 id="node-1-镜像打tag并传至私服">node-1 镜像打tag并传至私服 <a class="markdownIt-Anchor" href="#node-1-镜像打tag并传至私服">#</a></h1><pre class="hljs"><code>docker tag registry.access.redhat.com/rhel7/pod-infrastructure:latest registry:5000/pod-infrastructure:latest
docker push registry:5000/pod-infrastructure:latest

docker tag gcr.io/google_containers/kubernetes-dashboard-amd64:v1.7.1 registry:5000/kubernetes-dashboard-amd64:v1.7.1
docker push registry:5000/kubernetes-dashboard-amd64:v1.7.1

docker tag gcr.io/google_containers/k8s-dns-kube-dns-amd64:1.14.4 registry:5000/k8s-dns-kube-dns-amd64:1.14.4
docker push registry:5000/k8s-dns-kube-dns-amd64:1.14.4

docker tag myhub.fdccloud.com/library/kubedns-amd64:1.9 registry:5000/kubedns-amd64:1.9
docker push registry:5000/kubedns-amd64:1.9

docker tag myhub.fdccloud.com/library/kube-dnsmasq-amd64:1.4 registry:5000/kube-dnsmasq-amd64:1.4
docker push registry:5000/kube-dnsmasq-amd64:1.4

docker tag myhub.fdccloud.com/library/dnsmasq-metrics-amd64:1.0 registry:5000/dnsmasq-metrics-amd64:1.0
docker push registry:5000/dnsmasq-metrics-amd64:1.0

docker tag myhub.fdccloud.com/library/exechealthz-amd64:1.2 registry:5000/exechealthz-amd64:1.2
docker push registry:5000/exechealthz-amd64:1.2
</code></pre><h1 id="node-2-验证拉取私服镜像">node-2 验证拉取私服镜像 <a class="markdownIt-Anchor" href="#node-2-验证拉取私服镜像">#</a></h1><pre class="hljs"><code>docker pull registry:5000/pod-infrastructure:latest
docker pull registry:5000/kubernetes-dashboard-amd64:v1.7.1
docker pull registry:5000/k8s-dns-kube-dns-amd64:1.14.4
docker pull registry:5000/kubedns-amd64:1.9
docker pull registry:5000/kube-dnsmasq-amd64:1.4
docker pull registry:5000/dnsmasq-metrics-amd64:1.0
docker pull registry:5000/exechealthz-amd64:1.2
</code></pre><h1 id="master-部署etcd服务配置启动检查">master 部署etcd服务配置启动检查 <a class="markdownIt-Anchor" href="#master-部署etcd服务配置启动检查">#</a></h1><pre class="hljs"><code>yum install etcd -y
</code></pre><pre class="hljs"><code>[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># egrep -v '^#' /etc/etcd/etcd.conf | grep -v '^$'</span>
ETCD_DATA_DIR=<span class="hljs-string">"/var/lib/etcd/default.etcd"</span>
ETCD_LISTEN_CLIENT_URLS=<span class="hljs-string">"http://0.0.0.0:2379,http://0.0.0.0:4001"</span>
ETCD_NAME=<span class="hljs-string">"default"</span>
ETCD_ADVERTISE_CLIENT_URLS=<span class="hljs-string">"http://etcd:2379,http://etcd:4001"</span>
[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># </span>
</code></pre><pre class="hljs"><code>[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># systemctl start etcd</span>
[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># etcdctl set testdir/testkey0 0</span>
0
[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># etcdctl get testdir/testkey0</span>
0
[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># etcdctl -C http://etcd:4001 cluster-health</span>
member 8e9e05c52164694d is healthy: got healthy result from http://etcd:2379
cluster is healthy
[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># etcdctl -C http://etcd:2379 cluster-health</span>
member 8e9e05c52164694d is healthy: got healthy result from http://etcd:2379
cluster is healthy
[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># </span>
</code></pre><h1 id="master-kubernetes配置启动">master-kubernetes配置启动 <a class="markdownIt-Anchor" href="#master-kubernetes配置启动">#</a></h1><pre class="hljs"><code>[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># egrep -v '^#' /etc/kubernetes/apiserver | grep -v '^$'</span>
KUBE_API_ADDRESS=<span class="hljs-string">"--insecure-bind-address=0.0.0.0"</span>
KUBE_API_PORT=<span class="hljs-string">"--port=8080"</span>
KUBE_ETCD_SERVERS=<span class="hljs-string">"--etcd-servers=http://etcd:2379"</span>
KUBE_SERVICE_ADDRESSES=<span class="hljs-string">"--service-cluster-ip-range=10.254.0.0/16"</span>
KUBE_ADMISSION_CONTROL=<span class="hljs-string">"--admission-control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ResourceQuota"</span>
KUBE_API_ARGS=<span class="hljs-string">""</span>
[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># egrep -v '^#' /etc/kubernetes/config | grep -v '^$'</span>
KUBE_LOGTOSTDERR=<span class="hljs-string">"--logtostderr=true"</span>
KUBE_LOG_LEVEL=<span class="hljs-string">"--v=0"</span>
KUBE_ALLOW_PRIV=<span class="hljs-string">"--allow-privileged=false"</span>
KUBE_MASTER=<span class="hljs-string">"--master=http://k8s-master:8080"</span>
[root@iZuf63961c1lfkvsm4shneZ ~]<span class="hljs-comment"># </span>
</code></pre><pre class="hljs"><code>systemctl <span class="hljs-built_in">enable</span> kube-apiserver.service
systemctl start kube-apiserver.service
systemctl <span class="hljs-built_in">enable</span> kube-controller-manager.service
systemctl start kube-controller-manager.service
systemctl <span class="hljs-built_in">enable</span> kube-scheduler.service
systemctl start kube-scheduler.service
</code></pre><h1 id="node-1--node-2-kubernetes配置启动">node-1 node-2 kubernetes配置启动 <a class="markdownIt-Anchor" href="#node-1--node-2-kubernetes配置启动">#</a></h1><pre class="hljs"><code>[root@iZuf6apa66r2qwfw57sx8dZ ~]<span class="hljs-comment"># egrep -v '^#' /etc/kubernetes/config | grep -v '^$'</span>
KUBE_LOGTOSTDERR=<span class="hljs-string">"--logtostderr=true"</span>
KUBE_LOG_LEVEL=<span class="hljs-string">"--v=0"</span>
KUBE_ALLOW_PRIV=<span class="hljs-string">"--allow-privileged=false"</span>
KUBE_MASTER=<span class="hljs-string">"--master=http://k8s-master:8080"</span>
[root@iZuf6apa66r2qwfw57sx8dZ ~]<span class="hljs-comment"># egrep -v '^#' /etc/kubernetes/kubelet | grep -v '^$'</span>
KUBELET_ADDRESS=<span class="hljs-string">"--address=0.0.0.0"</span>
KUBELET_HOSTNAME=<span class="hljs-string">"--hostname-override=k8s-node-1"</span>
KUBELET_API_SERVER=<span class="hljs-string">"--api-servers=http://k8s-master:8080"</span>
KUBELET_POD_INFRA_CONTAINER=<span class="hljs-string">"--pod-infra-container-image=registry.access.redhat.com/rhel7/pod-infrastructure:latest"</span>
KUBELET_ARGS=<span class="hljs-string">"--cluster_dns=10.254.0.100 --cluster_domain=cluster.local"</span>
[root@iZuf6apa66r2qwfw57sx8dZ ~]<span class="hljs-comment"># </span>
</code></pre><pre class="hljs"><code>systemctl <span class="hljs-built_in">enable</span> kubelet.service
systemctl start kubelet.service
systemctl <span class="hljs-built_in">enable</span> kube-proxy.service
systemctl start kube-proxy.service
</code></pre><h1 id="master上查看集群中节点及节点状态">master上查看集群中节点及节点状态 <a class="markdownIt-Anchor" href="#master上查看集群中节点及节点状态">#</a></h1><pre class="hljs"><code>[root@k8s-master ~]<span class="hljs-comment">#  kubectl -s http://k8s-master:8080 get node</span>
NAME         STATUS    AGE
k8s-node-1   Ready     3m
k8s-node-2   Ready     16s
[root@k8s-master ~]<span class="hljs-comment"># kubectl get nodes</span>
NAME         STATUS    AGE
k8s-node-1   Ready     3m
k8s-node-2   Ready     43s
</code></pre><h1 id="master-node-安装证书">master node 安装证书 <a class="markdownIt-Anchor" href="#master-node-安装证书">#</a></h1><pre class="hljs"><code>yum install -y *rhsm*
wget http://mirror.centos.org/centos/7/os/x86_64/Packages/python-rhsm-certificates-1.19.10-1.el7_4.x86_64.rpm
rpm2cpio python-rhsm-certificates-1.19.10-1.el7_4.x86_64.rpm | cpio -iv --to-stdout ./etc/rhsm/ca/redhat-uep.pem | tee /etc/rhsm/ca/redhat-uep.pem
</code></pre><h1 id="master-node-安装flannel">master node 安装Flannel <a class="markdownIt-Anchor" href="#master-node-安装flannel">#</a></h1><p>创建覆盖网络——Flannel</p><pre class="hljs"><code>yum install flannel -y
</code></pre><p>master、node上均编辑/etc/sysconfig/flanneld</p><pre class="hljs"><code>[root@k8s-master ~]<span class="hljs-comment"># egrep -v '^#' /etc/sysconfig/flanneld | grep -v '^$'</span>
FLANNEL_ETCD_ENDPOINTS=<span class="hljs-string">"http://etcd:2379"</span>
FLANNEL_ETCD_PREFIX=<span class="hljs-string">"/atomic.io/network"</span>
[root@k8s-master ~]<span class="hljs-comment"># </span>
</code></pre><p>在master配置etcd中关于flannel的key</p><pre class="hljs"><code>[root@k8s-master ~]<span class="hljs-comment"># etcdctl mk /atomic.io/network/config '{ "Network": "10.0.0.0/16" }'</span>
{ <span class="hljs-string">"Network"</span>: <span class="hljs-string">"10.0.0.0/16"</span> }
</code></pre><p>启动Flannel之后，需要依次重启docker、kubernete。</p><p>在master执行：</p><pre class="hljs"><code>systemctl <span class="hljs-built_in">enable</span> flanneld.service 
systemctl start flanneld.service 
service docker restart
systemctl restart kube-apiserver.service
systemctl restart kube-controller-manager.service
systemctl restart kube-scheduler.service
</code></pre><p>在node上执行：</p><pre class="hljs"><code>systemctl <span class="hljs-built_in">enable</span> flanneld.service 
systemctl start flanneld.service 
service docker restart
systemctl restart kubelet.service
systemctl restart kube-proxy.service
</code></pre><h1 id="安装kube-dns">安装kube-dns <a class="markdownIt-Anchor" href="#安装kube-dns">#</a></h1><p>在master上安装</p><pre class="hljs"><code>kubectl create -f https://raw.githubusercontent.com/koy1619/k8s_yaml/master/kubedns-rc.yaml
kubectl create -f https://raw.githubusercontent.com/koy1619/k8s_yaml/master/kubedns-svc.yaml
</code></pre><p>修改各node节点上的/etc/kubernetes/kubelet配置文件，增加如下行：</p><pre class="hljs"><code>KUBELET_ARGS=<span class="hljs-string">"--cluster_dns=10.254.0.100 --cluster_domain=cluster.local"</span>
</code></pre><p>重启各节点：</p><pre class="hljs"><code>systemctl restart kubelet
</code></pre><h1 id="部署dashboard服务">部署dashboard服务 <a class="markdownIt-Anchor" href="#部署dashboard服务">#</a></h1><pre class="hljs"><code>kubectl create -f https://raw.githubusercontent.com/koy1619/k8s_yaml/master/dashboard-controller.yaml
kubectl create -f https://raw.githubusercontent.com/koy1619/k8s_yaml/master/dashboard-service.yaml
</code></pre><h1 id="master上面查看pod">master上面查看pod <a class="markdownIt-Anchor" href="#master上面查看pod">#</a></h1><pre class="hljs"><code>kubectl get pod  -o wide  --all-namespaces
</code></pre><h1 id="dashboard访问">dashboard访问 <a class="markdownIt-Anchor" href="#dashboard访问">#</a></h1><p><a href="http://10.1.1.100:8080/ui" target="_blank" rel="noopener">http://10.1.1.100:8080/ui</a></p><p>some exception ...</p><pre class="hljs"><code> [root@k8s-master ~]<span class="hljs-comment"># kubectl describe pods kubernetes-dashboard-1607234690-3bnk2 --namespace=kube-system</span>

  1s    1s    1 {kubelet k8s-node2}           Warning   FailedSync  Error syncing pod, skipping: failed to <span class="hljs-string">"StartContainer"</span> <span class="hljs-keyword">for</span> <span class="hljs-string">"kubernetes-dashboard"</span> with CrashLoopBackOff: <span class="hljs-string">"Back-off 10s restarting failed container=kubernetes-dashboard pod=kubernetes-dashboard-980055440-l9zl5_kube-system(870d02e1-7810-11e7-9517-000c296a54e8)"</span>
  

[解决方案]
[root@k8s-master ~]<span class="hljs-comment"># vim kubenetes-dashboard.yaml</span>
- --apiserver改成ip，不要使用域名
</code></pre><pre class="hljs"><code>访问kubernetes dashboard UI报错
Error: <span class="hljs-string">'dial tcp 10.0.66.2:9090: getsockopt: connection timed out'</span>
Trying to reach: <span class="hljs-string">'http://10.0.66.2:9090/'</span>

原因是master节点和node节点flannel 的网络通信有问题
解决方法： 
1.检查flannel配置；依次重启master和node节点flannel
systemctl restart flanneld
在重建
kubectl create -f dashboard-controller.yaml
kubectl create -f dashboard-service.yaml

2.检查iptables -L -n ，检查node节点上的FORWARD 查看转发是否是drop，如果是drop，则开启
iptables -P FORWARD ACCEPT
在master可以curl通 http://10.0.66.2:9090
</code></pre><p>以下为参考资料</p><pre class="hljs"><code>https://www.cnblogs.com/zhenyuyaodidiao/p/6500897.html
https://blog.csdn.net/bbwangj/article/details/81701300
https://andrewpqc.github.io/2018/04/23/setup-kubernetes-cluster-with-kubeadm/
https://andrewpqc.github.io/2018/04/24/setup-k8s-dashboard-on-cluster/
https://www.cnblogs.com/djhull/archive/2016/12/02/6125130.html
https://blog.csdn.net/xts_huangxin/article/details/51130223
https://blog.csdn.net/weixin_34054866/article/details/87525597

https://blog.csdn.net/wt334502157/article/details/83992120
https://www.cnblogs.com/allcloud/p/7614123.html
https://hub.docker.com
https://my.oschina.net/u/2539854/blog/3023384
https://www.cnblogs.com/lion.net/p/10408510.html
</code></pre><p>常用命令备忘</p><pre class="hljs"><code>kubectl create -f kubedns-rc.yaml
kubectl create -f kubedns-svc.yaml
kubectl create -f dashboard-controller.yaml
kubectl create -f dashboard-service.yaml

kubectl delete -f dashboard-controller.yaml
kubectl delete -f dashboard-service.yaml
kubectl delete -f kubedns-rc.yaml
kubectl delete -f kubedns-svc.yaml
</code></pre><pre class="hljs"><code>kubectl -s http://k8s-master:8080 get node
kubectl get pods --namespace kube-system
kubectl get pod  -o wide  --all-namespaces
kubectl describe pod kube-dns-598252076-hks4w --namespace=kube-system
kubectl logs -f kubernetes-dashboard-2106745705-zz1qp -n kube-system
kubectl logs -f kube-dns-2842662617-65n8h -n kube-system -c kubedns
kubectl logs -f kube-dns-2842662617-65n8h -n kube-system -c dnsmasq-metrics
</code></pre><pre class="hljs"><code><span class="hljs-comment">#master删除节点</span>
kubectl delete node node2
<span class="hljs-comment">#看日志</span>
kubectl logs -f kubernetes-dashboard-2891849301-9g3hb -n kube-system
kubectl logs -f kube-dns-3298054597-lk7gf -n kube-system -c kubedns
kubectl logs -f kube-dns-2842662617-w7t5q -n kube-system -c dnsmasq-metrics
<span class="hljs-comment">#登陆docker实例</span>
kubectl get pods
kubectl <span class="hljs-built_in">exec</span> -it nginx-3873632884-zhfzt -- /bin/bash
</code></pre></div><h2>您的评论</h2><div id="disqus_thread"></div><script>var disqus_config=function(){this.page.url=location.origin+location.pathname,this.page.identifier=location.pathname,"/index.html"===this.page.identifier.substr(-11)&&(this.page.identifier=this.page.identifier.substr(0,this.page.identifier.length-10))};!function(){var i=document,e=i.createElement("script");e.src="//linux48.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(i.head||i.body).appendChild(e)}()</script><div class="level article-bar is-mobile"><div class="level-item has-text-centered"><a title="previous page" class="previouse-article-link" href="index.html"><span class="icon icon-previous" data-icon="previous"></span><span class="link-content">&laquo; Previous</span></a></div><div class="level-item has-text-centered"><a title="font size" class="link-item link-item-size"><span class="icon icon-size" data-icon="size"></span></a></div><div class="level-item has-text-centered"><a title="table of content" class="link-item link-item-toc"><span class="icon icon-toc" data-icon="toc"></span></a></div><div class="level-item has-text-centered"><a title="top" href="#"><span class="icon icon-up" data-icon="up"></span> <span class="link-content">⤊ Top</span></a></div><div class="level-item has-text-centered"><a title="next page" class="next-article-link" href="2019-01-23-redis-sentinel.html"><span class="icon icon-next" data-icon="next"></span><span class="link-content">Next &raquo;</span></a></div></div></div><div class="column is-2-widescreen is-hidden"></div></div><div class="columns foot"><div class="column is-3 is-offset-9 build-by">Build by <a href="https://github.com/ruanyf/loppo" target="_blank">Loppo</a> 0.6.14</div></div><div class="book-toc notification is-warning is-hidden"><h3>目录&nbsp;<span class="title-close"><a class="button is-danger"> Close</a></span></h3><ul class="chapter-area"><li class="chapter-item chapter-item-current"><a href="2019-07-12-k8s.html">kubernetes集群搭建</a></li><li class="chapter-item"><a href="2019-01-23-redis-sentinel.html">redis-sentinel安装配置</a></li><li class="chapter-item"><a href="2018-12-11-mha.html">MySQL高可用之MHA</a></li><li class="chapter-item"><a href="2018-11-22-redis-think.html">使用Redis的一些想法和建议</a></li><li class="chapter-item"><a href="2018-11-15-redis-rdb-tools.html">使用redis-rdb-tools分析Redis内存</a></li><li class="chapter-item"><a href="2017-06-12-RDS-recovery-local-mysql.html">RDS备份文件恢复到自建数据库</a></li><li class="chapter-item"><a href="2017-06-08-excel-merge.html">多个EXCEL文件合并成一个EXCEL</a></li><li class="chapter-item"><a href="2017-05-24-redis-twemproxy.html">基于Twemproxy的Redis集群方案</a></li><li class="chapter-item"><a href="2017-02-28-zabbix-redis.html">zabbix使用自动发现规则自动化监控redis多实例</a></li><li class="chapter-item"><a href="2016-09-10-mysqlsla.html">MySQL慢日志分析工具mysqlsla</a></li><li class="chapter-item"><a href="2016-09-15-redis-stat.html">Redis-stat的安装与使用</a></li><li class="chapter-item"><a href="2016-07-06-zabbix3.0-mail.html">zabbix 3.0邮件报警</a></li><li class="chapter-item"><a href="2016-06-30-hive-hdfs.html">hive整合hadoop通过flume+hue收集日志</a></li><li class="chapter-item"><a href="2016-05-27-mysql-duplicate-records.html">MySQL查询表内重复记录</a></li><li class="chapter-item"><a href="2016-05-24-free-ssl.html">Startssl免费SSL证书+Nginx搭建https</a></li><li class="chapter-item"><a href="2016-05-16-flume.html">flume+hdfs构建大数据</a></li><li class="chapter-item"><a href="2016-04-21-notepad.html">数据库维护文本编辑技巧记录</a></li><li class="chapter-item"><a href="2016-04-20-mysql-in-paixu.html">MySQL查询按IN的顺序输出结果</a></li><li class="chapter-item"><a href="2016-04-14-cisco-firewall-ha.html">CISCO ASA5520 HA 配置</a></li><li class="chapter-item"><a href="2016-04-09-centos7-config-bond.html">centos7配置bond和bond跨网段改IP</a></li><li class="chapter-item"><a href="2016-02-03-centos-install-bugzilla.html">CentOS下Nginx配置Perl运行Bugzilla</a></li><li class="chapter-item"><a href="2015-11-12-centos-install-maven.html">CentOS上搭建私有maven仓库(迁移，升级)</a></li><li class="chapter-item"><a href="2015-10-8-mysql-some-question.html">mysql You cant specify target table</a></li><li class="chapter-item"><a href="2015-10-30-mysql-row-usedisk.html">mysql中查看数据库中所有表的记录数</a></li><li class="chapter-item"><a href="2015-10-29-zabbix-proxy-install.html">zabbix的proxy端安装配置</a></li><li class="chapter-item"><a href="2015-10-28-zabbix-agent-install.html">zabbix的agent端安装配置</a></li><li class="chapter-item"><a href="2015-10-27-mysql-AVG-MIN-SUM.html">mysql求平均值、最小和总值</a></li><li class="chapter-item"><a href="2015-10-21-mysql-every-hour.html">mysql取每隔一小时数据</a></li><li class="chapter-item"><a href="2015-08-27-Write-through-back.html">阵列Cache写机制：Write-through与Write-back</a></li><li class="chapter-item"><a href="2015-08-03-win10-cisco-vpn-repair.html">Repair Cisco vpnclient on windows10</a></li><li class="chapter-item"><a href="2015-07-30-sql-concat.html">MYSQL在一个字段值前面加字符串</a></li><li class="chapter-item"><a href="2015-07-22-Primary-key-conflicts.html">mysql双主主键冲突排查修复</a></li><li class="chapter-item"><a href="2015-07-15-mysql-dual-master.html">mysql双主互备设计搭建</a></li><li class="chapter-item"><a href="2015-07-07-svn-admin.html">CentOS6安装subversion 可视化管理工具iF.SVNAdmin</a></li><li class="chapter-item"><a href="2015-07-06-rhel-yum.html">Red Hat Enterprise Linux Server YUM配置</a></li><li class="chapter-item"><a href="2015-06-25-mysql-log.html">mysql全局日志开启</a></li><li class="chapter-item"><a href="2015-06-08-php-fpm-backlog.html">关于PHP-FPM的backlog</a></li><li class="chapter-item"><a href="2015-06-05-mysql-grant.html">MySQL的Grant赋权命令详解</a></li><li class="chapter-item"><a href="2015-06-03-bitnami-gitlab-port.html">bitnami版gitlab修改端口</a></li><li class="chapter-item"><a href="2015-03-13-awstats-install.html">awstats日志分析安装</a></li><li class="chapter-item"><a href="2015-03-07-h3c-vlan.html">H3C划分VLAN命令</a></li><li class="chapter-item"><a href="2015-03-05-redis-easy-install.html">Redis安装及主从配置</a></li><li class="chapter-item"><a href="2015-01-21-shadowsocks-python-node.html">shadowsocks的python和nodejs版搭建</a></li><li class="chapter-item"><a href="2015-01-07-ruby-Syntax-error-Invalid-GBK.html">ruby环境sass编译中文出现 Invalid GBK character</a></li><li class="chapter-item"><a href="2015-01-06-mysql-m-s-s.html">如何搭master-slave-slave</a></li><li class="chapter-item"><a href="2015-01-06-mysql5.1-ms.html">Mysql5.1主从服务设置</a></li><li class="chapter-item"><a href="2015-01-06-linux-rm-luanma.html">linux下删除乱码文件</a></li><li class="chapter-item"><a href="2014-12-17-SVNListParentPath.html">利用SVNListParentPath增加http浏览仓库根目录的功能</a></li><li class="chapter-item"><a href="2014-12-15-Chrome-css-failed.html">Chrome 浏览器加载 css Failed to load resource</a></li><li class="chapter-item"><a href="2014-12-04-centos-gitlab-yijian.html">centos gitlab一键安装备份恢复和迁移</a></li><li class="chapter-item"><a href="2014-12-02-linux-sar.html">linux sar命令</a></li><li class="chapter-item"><a href="2014-11-24-ruby-on-rails-err.html">ruby on rails 报错解决</a></li><li class="chapter-item"><a href="2014-11-18-awk-note.html">AWK统计随笔记录</a></li><li class="chapter-item"><a href="2014-11-12-svn-force-commit.html">SVN强制提交commit</a></li><li class="chapter-item"><a href="2014-11-12-rm-list-too-long.html">rm Argument list too long的解决办法</a></li><li class="chapter-item"><a href="2014-11-12-crontab-linux-lessthan.html">Crontab导致Linux的线程数枯竭</a></li><li class="chapter-item"><a href="2014-11-11-shell-ftp-uplod.html">用二句Shell命令实现FTP批量上传文件夹</a></li><li class="chapter-item"><a href="2014-11-10-redis-disk-memory-err.html">redis 写磁盘出错Cannot allocate memory</a></li><li class="chapter-item"><a href="2014-10-19-Jekyll_Variables.html">Jekyll目录结构与变量</a></li><li class="chapter-item"><a href="2014-10-19-git_common_command.html">Git 常用命令整理</a></li><li class="chapter-item"><a href="2014-10-18-windows_configuration_Jekyll.html">Windows平台配置Jekyll环境并与GitHub连接</a></li><li class="chapter-item"><a href="2014-08-21-centos-kvm-install.html">Redhat/CentOS系统KVM虚拟机安装过程详解</a></li><li class="chapter-item"><a href="2014-08-18-Sublime-add-youjian.html">将sublime text添加到右键菜单中</a></li><li class="chapter-item"><a href="2014-08-13-Sublime-python-build.html">Sublime Text 3设置python编译支持环境设置</a></li><li class="chapter-item"><a href="2014-08-11-shell-syntax-error.html">SHELL syntax error:unexpected end of file 提示错误</a></li><li class="chapter-item"><a href="2014-07-31-mysql-daxiaoxie.html">Windows下MySQL无法区分大小写解决方案</a></li><li class="chapter-item"><a href="2014-07-31-CentOS-NFS-mount.html">CentOS NFS的安装配置、启动及mount挂载方法</a></li><li class="chapter-item"><a href="2014-07-30-tencent-yun-repo.html">腾讯云的YUM repo</a></li><li class="chapter-item"><a href="2014-07-29-mysql-dump-all.html">Mysqldump参数大全</a></li><li class="chapter-item"><a href="2014-07-28-git-del-err-commit.html">git删除错误提交的commit</a></li><li class="chapter-item"><a href="2014-07-25-mysql-instet-other-table.html">MySql中把一个表的数据插入到另一个表中的实现</a></li><li class="chapter-item"><a href="2014-07-25-centos-install-ossec.html">centos安装ossec</a></li><li class="chapter-item"><a href="2014-07-24-phpmyadmin-error.html">访问phpmyadmin错误</a></li><li class="chapter-item"><a href="2014-07-13-black-apple.html">厚黑苹果售后</a></li><li class="chapter-item"><a href="2014-06-25-wordpress-google-css.html">wordpress引用google开放css加载不到解决方法</a></li><li class="chapter-item"><a href="2014-06-25-nginx-https.html">centos下nginx的https配置</a></li><li class="chapter-item"><a href="2014-05-30-rsync.html">rsync同步部署</a></li><li class="chapter-item"><a href="2014-05-15-saltstack1.html">使用saltstack批量管理服务器 （一）</a></li><li class="chapter-item"><a href="2014-04-18-msmtpmutt.html">msmtp+mutt 服务器批量发送邮件</a></li><li class="chapter-item"><a href="2014-04-14-zabbix-server-install.html">zabbix的server端安装配置</a></li><li class="chapter-item"><a href="2014-04-05-wordpress-them-only-one.html">wordpress后台主题只有一个解决方法</a></li><li class="chapter-item"><a href="2014-01-30-many-php-version.html">多版本php共存搭建</a></li><li class="chapter-item"><a href="2013-11-06-linux-memery-cat.html">linux查看内存相关命令</a></li><li class="chapter-item"><a href="2013-07-07-github-easy-install.html">github安装使用</a></li><li class="chapter-item"><a href="2013-06-30-localhost-127.0.0.1.html">localhost 与 127.0.0.1 的区别</a></li><li class="chapter-item"><a href="2013-06-15-rsync-del-hailiang.html">使用rsync删除海量文件</a></li><li class="chapter-item"><a href="2013-06-08-disk-data-recovery.html">记录一次服务器数据恢复</a></li><li class="chapter-item"><a href="2013-06-03-1nginx-502.html">记录一次nginx 502</a></li><li class="chapter-item"><a href="2013-06-02-linux-nohup.html">linux命令后台运行详解</a></li><li class="chapter-item"><a href="2013-06-01-disk-inode.html">深入理解磁盘inode</a></li><li class="chapter-item"><a href="2013-05-09-mysql-error-1064.html">MySQL错误ERROR 1064 (type=myisam出错)</a></li><li class="chapter-item"><a href="2013-01-04-centos-php-oracle.html">centos6.2下php支持oracle</a></li><li class="chapter-item"><a href="2012-12-27-oracle-startup-failure.html">oracle startup failure</a></li><li class="chapter-item"><a href="2012-12-27-oracle-startup.html">oracle startup 故障：ORA-00845: MEMORY_TARGET</a></li><li class="chapter-item"><a href="2012-12-27-ora-01102-cannot-mount-database-in-exclusive-mode.html">ORA-01102: cannot mount database in EXCLUSIVE mode</a></li><li class="chapter-item"><a href="2012-12-20-centos-install-oracle-11g.html">centos install oracle 11g</a></li><li class="chapter-item"><a href="2012-11-14-mysql-slow-log.html">Mysql慢查询设置</a></li><li class="chapter-item"><a href="2012-11-14-mysql-ms-error.html">MYSQL主从同步故障事件</a></li><li class="chapter-item"><a href="2012-08-10-python-mysqldb-install.html">CentOS下python-mysqldb安装事件</a></li><li class="chapter-item"><a href="2012-08-03-sqlite-source-upgrade.html">sqlite3源码升级事件</a></li><li class="chapter-item"><a href="2012-08-01-centos6-pythonsqlite3.html">centos6.2升级python后处理sqlite3库事件</a></li><li class="chapter-item"><a href="2012-07-30-mysql5-5-ms.html">mysql5.5版本主从搭建</a></li><li class="chapter-item"><a href="2012-07-18-repair-yum.html">误卸载python导致yum无法使用修复事件</a></li><li class="chapter-item"><a href="2012-07-18-reload-upgrade-python.html">Centos平滑升级python事件</a></li><li class="chapter-item"><a href="2012-07-18-nginx413.html">Nginx出现“413 Request Entity Too Large”错误解决方法</a></li><li class="chapter-item"><a href="2012-07-06-nginx-apache-mulu-bd.html">Nginx、Apache目录浏览功能</a></li><li class="chapter-item"><a href="2012-06-27-yum-lamp-tomcat.html">CentOS yum安装配置LAMP+tomcat</a></li><li class="chapter-item"><a href="2012-06-11-ios-jiangji.html">ios5.0.1降级4.3.3事件</a></li><li class="chapter-item"><a href="2012-05-17-ocr-Tesseract.html">OCR之Tesseract的linux下安装</a></li><li class="chapter-item"><a href="2012-05-04-memcached-easy-install.html">memcached简易安装</a></li><li class="chapter-item"><a href="2012-04-11-centos-install-snmp.html">centos下snmp客户端安装</a></li><li class="chapter-item"><a href="2012-03-13-iptables-shell.html">一篇很不错的iptables的shell</a></li><li class="chapter-item"><a href="2012-03-07-cisco-fudong-luyou.html">思科静态浮动路由配置</a></li><li class="chapter-item"><a href="markdown.html">Markdown 简明语法手册</a></li><li class="chapter-item"><a href="hello-world.html">Hello World</a></li></ul></div><div class="progress-indicator"></div><!-- SCRIPTS --><script>var LOPPO={current_path:"2019-07-12-k8s.md",relative_root_path:"",article_toc:""}</script><script src="assets/js/app.js"></script></body></html>